
@if(page(); as p) {
<div class="w-full h-full bg-stone-50 p-6 md:p-8 shadow-[inset_4px_0px_8px_rgba(0,0,0,0.1)] border-l-2 border-gray-200 overflow-y-auto">
  <header class="flex justify-between items-center border-b-2 border-black pb-2 mb-4">
    <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQB4KvHC5naNkg0f_3ae3VjhfgfXAirExue26iB1PrTuQ&s=10" alt="Board Logo" class="h-12 w-12">
    <div class="text-center">
      <h2 class="font-bold text-lg">{{ paper()?.title }}</h2>
      <h3 class="font-semibold">{{ paper()?.subject }}</h3>
    </div>
    <div class="text-right">
      <p class="font-bold">Total Marks: {{ paper()?.totalMarks }}</p>
      <p>Duration: {{ paper()?.duration }}</p>
    </div>
  </header>
  
  <main class="space-y-4">
    @if (p.pageNumber === 1) {
      <div class="text-center mt-20">
        <h1 class="text-3xl font-bold mb-8">{{ paper()?.subject }}</h1>
        <div class="text-left max-w-2xl mx-auto border-2 border-black p-6">
          <h4 class="text-xl font-bold mb-4 underline">Instructions:</h4>
          <ul class="list-decimal list-inside space-y-2">
            @for(instruction of paper()?.instructions; track instruction) {
              <li>{{ instruction }}</li>
            }
          </ul>
        </div>
      </div>
    } @else if (p.content.length > 0 && p.content[0].title === 'ROUGH WORK') {
       <div class="w-full h-5/6 border-2 border-dashed border-gray-400 flex items-center justify-center">
        <h1 class="text-4xl font-bold text-gray-300 transform -rotate-12">ROUGH WORK</h1>
      </div>
    } @else {
      @for(section of p.content; track section.title) {
        <section class="space-y-3">
          <h4 class="text-xl font-bold border-b border-gray-400 pb-1">{{ section.title }}</h4>
          <p class="text-sm italic text-gray-600">{{ section.instructions }}</p>

          @for(question of section.questions; track question.id) {
            <div class="pl-2">
              <div class="flex justify-between">
                <p class="font-semibold" [innerHTML]="question.text"></p>
                <p class="font-semibold">[{{ question.marks }} Marks]</p>
              </div>

              @if (question.subQuestions) {
                @for(sub of question.subQuestions; track sub.id) {
                  <div class="ml-4 my-3">
                    <div class="flex justify-between items-start">
                      <p class="flex-1 pr-4">{{ sub.text }}</p>
                      <p>[{{ sub.marks }}]</p>
                    </div>
                    @if(sub.type === 'mcq' && sub.options) {
                       <div class="grid grid-cols-2 md:grid-cols-4 gap-2 mt-2">
                        @for(option of sub.options; track option) {
                          <label class="flex items-center space-x-2">
                            <input type="radio" [name]="sub.id" [value]="option" [checked]="paperService.answers()[sub.id] === option" (change)="onAnswerChange(sub.id, $event)">
                            <span>{{ option }}</span>
                          </label>
                        }
                       </div>
                    } @else {
                      <textarea class="w-full mt-1 p-2 border border-gray-300 rounded-md bg-stone-100 h-20" placeholder="Type your answer here..." [value]="paperService.answers()[sub.id] || ''" (input)="onAnswerChange(sub.id, $event)"></textarea>
                    }
                  </div>
                }
              }
            </div>
          }
        </section>
      }
    }
  </main>

  <footer class="absolute bottom-4 right-6 font-bold">
    Page {{ p.pageNumber }} / {{ paper()?.totalPages }}
  </footer>
</div>
}
